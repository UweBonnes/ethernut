$Id: ChangeLog,v 1.202 2005/04/28 16:26:31 haraldkipp Exp $

2005-04-28  Harald Kipp  <harald.kipp@egnite.de>

	* configure.ac, Makefile.am, doc/Makefile.am, 
	doc/gen/Makefile.am, tools/crurom/Makefile.am, 
	tools/nutconf/Makefile.am: Support for autoconf/automake
	added. This is far from working perfect, but at least
	builds an installation on Fedora Core 3.

	* AUTHORS COPYING INSTALL NEWS: Standard distribution doc files
	added.

	* reconf: Helper script for package building added.

	* doc/gen/nut_en.cfg.in: Replaces nut_en.cfg, which is now
	created by autoconf.

	* tools/packaging/ethernut.spec.in: Replaces the previous
	rpm spec, which is now created by autoconf.

	* configure: This file stands in the way of autoconf and has
	been renamed to nutsetup. Hopefully the executable permission
	will now be preserved.

	* Makefile: This file stands in the way of automake and has
	been moved to the lib subdirectory. If you are building in the
	source tree, then you must cd to lib first before running make.

	* tools/crurom/crurom.c, tools/nutconf/nutcomponent.c: 
	Include autoheader file.

	* nut/tools/nutconf/repoptdlg.cpp: No idea why OFN_HIDEREADONLY
	is undefined on Fedora. File dialog option removed.


2005-04-26  Harald Kipp  <harald.kipp@egnite.de>

	* tools/nutconf/enumeditctrl.cpp, tools/nutconf/enumeditctrl.h: 
	Workaround for wxChoice focus bug on GTK+ added.

	* tools/nutconf/scrolledtree.cpp, tools/nutconf/valuewindow.cpp: 
	Minor wxWidgets runtime warning avoided.


2005-04-25  Harald Kipp  <harald.kipp@egnite.de>

	* tools/nutconf/configtree.cpp: Compile fix for the new
	wxWidgets 2.6.0.


2005-04-22  Harald Kipp  <harald.kipp@egnite.de>

	* app/Makeburn.avr-dude: Support for avrdude, kindly provided by
	Martin Thomas.

	* tools/nutconf/nutcomponent.c, tools/nutconf/nutconf.h: 
	Version 1.2.1 can now run without GUI or with wxWidgets 2.5.5.

	* tools/nutconf/appoptdlg.cpp, tools/nutconf/bldoptdlg.cpp,
	tools/nutconf/configitem.cpp, tools/nutconf/configtree.cpp,
	tools/nutconf/enumeditctrl.cpp, tools/nutconf/inteditctrl.cpp,
	tools/nutconf/mainframe.cpp, tools/nutconf/propertylist.cpp,
	tools/nutconf/repoptdlg.cpp, tools/nutconf/splitscroll.cpp,
	tools/nutconf/texteditctrl.cpp, tools/nutconf/treecomp.cpp,
	tools/nutconf/valuewindow.cp: Marked unused function parameters 
	to avoid compiler warnings.

	* tools/nutconf/configitem.cpp, tools/nutconf/configtree.cpp,
	tools/nutconf/nutconf.cpp, tools/nutconf/nutconfdoc.cpp,
	tools/nutconf/repoptdlg.cpp, tools/nutconf/scrolledtree.cpp,
	tools/nutconf/splitscroll.cpp, tools/nutconf/treecomp.cpp,
	tools/nutconf/valuewindow.cpp: Upgraded to wxWidgets 2.5.5.
	Mainly replaced deprecated functions.

	* tools/nutconf/dirent.c, tools/nutconf/dirent.h,
	tools/nutconf/getopt.c, tools/nutconf/getopt.h:
	Files added to support non-GUI Configurator.

	* tools/nutconf/nutconfdoc.cpp: Added support for building
	ICCAVR applications in the sample tree.


2005-04-19  Matthias Ringwald <mringwal@.inf.ethz.ch>

	* include/unistd.h: added #include <compiler.h> as the implicit
	ordering is not sufficient on our red hat machines. relevant
	to unix emulation.

2005-04-19  Harald Kipp  <harald.kipp@egnite.de>

	* app/ftpd/ftpserv.c: Compiler warning added, if target is not
	Ethernut 2.

	* app/inetq/inetq.c: More detailed description added.

	* app/tcps/tcps.c: Description updated.

	* app/timers/timers.c: Description updated and ARM support added.

	* crt/putf.c: Support for size_t modifier added. Thanks to Tom 
	Lynn.


2005-04-15  Ole Reinhardt <ole.reinhardt@embedded-it.de>
	* dev/unix_devs.c
        Changed the delimiting of the nativeName into ip and port. 
        Now first check if nativeName == "stdio". Otherwise strtok will 
        segfault. Strange... Perhaps a problem with the static declaration 
        of the option strings? I don't know. Very mysterious.

2005-04-08  Ole Reinhardt <ole.reinhardt@embedded-it.de>
	* net/arpin.c, net/arpout.c, net/ethin.c, net/ethout.c,
          net/ipcpin.c, net/ipcpout.c, net/ipout.c, net/lcpin.c,
          net/lcpout.c, net/papin.c, net/papout.c, net/pppdebug.c,
          net/pppin.c, net/pppout.c, net/udpsock.c, net/tcpin.c, 
	  pro/sntp.c, pro/wins.c,
	added <sys/types.h> (__APPLE__) and <netinet/in.h> (__linux__) 
	for htons and simmilar. 
        Fixes to make the unix emulation compiling again. Hope this won't 
	break anything.

2005-04-04  Matthias Ringwald <mringwal@.inf.ethz.ch>

	* include/irqreg.h, include/irqreg_unix.h: most unix emulation
        specific stuff now in irqreg_unix.h. #warning "MCU not defined"

2005-04-05  Harald Kipp  <harald.kipp@egnite.de>

	* os/version.c: Updated for the next pre-release 3.9.6. Still
	no version 4, because of several problems with ARM7 (see below). 
	Anyway, most applications should now run on the ARM CPU with 
	minor or no modification.

	* include/netinet/if_ether.h, include/netinet/ip.h,
	include/netinet/tcp.h: Finally the TCP/IP stack is running on 
	the ARM7 platform. Added the 'packed' attribute to several 
	protocol structures.

	* net/ipcsum.c, include/netinet/ipcsum.h: Northern hemisphere 
	spring cleaning ;-). This part contained a lot of garbage and 
	left overs. The AVRGCC inline assembly from Liquorice seemed to 
	be buggy, the ImageCraft inline assembly didn't work better than 
	compiled code, NutIpPseudoChkSum() was never called and nothing 
	worked on 32 bit little endian machines. This whole mess had 
	been radically replaced by a generic routine. Now we have room 
	for new and clean optimizations.

	* net/tcpout.c: Inclusion of stdio header removed. These headers 
	are useful during debugging, but may cause a lot of trouble 
	later, if you forget to remove all print statements. Without the 
	stdio header file, the compiler takes care that all debug 
	outputs are removed.

	* include/sys/atom.h: NutEnter/ExitCritical for ARM7 added. 
	I missed to commit this earlier, sorry.

	* conf/dev/dev.nut, conf/net/net.nut, conf/pro/pro.nut,
	dev/ahdlcavr.c, net/pppsm.c, net/tcpsm.c, pro/dhcpc.c,
	pro/sntp.c: Configurable stack sizes. Because of larger 
	registers and memory alignment, ARM CPUs consume a lot more 
	stack.

	* include/cfg/ahdlc.h, include/cfg/ppp.h, include/cfg/sntp.h,
	include/cfg/tcp.h: Placeholders added to allow building
	in the source tree.

	* conf/dev/dev.nut, dev/ax88796.c, dev/reg_ax88796.h, 
	include/dev/ax88796.h: ARM7 Ethernet driver for Asix' AX88796 
	added. Many thanks to Marek Hummel for the initial work.

	* dev/debug_at91.c, include/dev/debug.h: Hacked to make it work 
	on USART0. Initialization had been removed too, because I do 
	not have the time for a nicer porting. This probably breaks the
	implementation for the AT91EB40A, but to my knowledge I'm to 
	only user. :)

	* dev/debug_gba.c, os/arch/arm_timer.c, include/arch/gba.h: More 
	consistent register naming for the Gameboy Advance. The hardware
	definitions are now in the central file gba.h. Additionally I 
	cleaned up the AT91 timer handling.

	* dev/irqreg.c, include/dev/irqreg.h, include/dev/irqreg_arm.h,
	os/arch/arm_nutinit.c, dev/gba_irqreg.c: Implements conformant 
	interrupt registration for the Gameboy Advance. Still no 
	solution for the AT91.

	* os/arch/arm_thread.c: ARM threads are now running in system
	mode instead of very limited user mode. I alos removed some less
	helpful debug outputs. The big problem with the initial port
	still exists: It is not yet possible to pass a parameter to
	another thread. Important note: Due to the mode change the 
	Gameboy startup needs to be fixed. Again, since I'm the only 
	user running Nut/OS on the GBA, who cares?

	* pro/dhcpc.c: No parameter parsing to threads when running
	on ARM. Using a global variable until this is fixed.

	* include/arch/at91.h: Previous interrupt handling allowed 
	nesting. This was nice, but regularly crashed the system. 
	Nesting has been disabled.

	* conf/fs/fs.nut: UROM file system isn't limited to AVR.

	* conf/net/net.nut: TCP provides device read and write. Even if
	no other devices are available, stdio read and write should be
	included in the build.

	* app/Makedefs.arm-gcc, crt/fwrite.c, net/tcpsock.c, pro/httpd.c:
	No decision about ARM runtime lib, so we go without any. The main 
	problem is integer division, which demands assembly language
	routines. As a temporary solution these parts had been excluded
	from the code. The result is, that fwrite will return the number 
	of bytes instead of the number of items and that HTTP parameter 
	parsing is not available.

	* arch/arm/init/crtwolf_ram.S, arch/arm/ldscripts/wolf_ram.ld, 
	app/httpd/httpserv.c, conf/wolf.conf, conf/repository.nut,
	conf/tools.nut: Added support for the Wolf prototype board, which 
	uses the AT91R40008 CPU and the AX88796 Ethernet controller.
	Right now there is no support for ROM-able applications. Our 
	prototypes run 'armboot' from FLASH and load the Nut/OS 
	application via TFTP into the internal RAM. Special thanks to 
	Marek Hummel for providing this ported armboot and to hwgroup 
	for the hardware.

	* app/threads/threads.c, app/timers/timers.c: Applications can 
	run on the Gameboy Advance.

	* dev/uartgba.c, include/dev/uartgba.h: UART support for the 
	Gameboy Advance using MBV II hardware. Unfortunately it doesn't
	work as expected. It sends and receives characters somehow, but 
	the number of characters is quite random. If someone else with 
	some spare time is interested...


2005-04-04  Matthias Ringwald <mringwal@.inf.ethz.ch>

	* configure, Makefile, include/netdb.h, include/sys/socket.h,
	include/netinet/in.h: added creation of include/netdb_orig.h,
	include/sys/socket_orig.h and include/netinet/in_orig.h to allow unix
	emulation to use tcp/ip sockets.

	* dev/unix_devs.c, include/dev/unix_devs.h: added socket redirection
	feature for unix emulation uarts. Every nut/os uart device can now be mapped
	to a TCP/IP socket using the "-u{0/1/2} hostname:port" command line option.

	* os/arch/unix_options.c: clean up of usage message.
	
2005-03-30  Michael Jones <Michael.e.Jones@web.de>

	* net/tcpsm.c: Defussed race condition in NutTcpStateActiveOpenEvent
	where the NutEventWait would be called after sock->so_ac_tq had been
	signaled and therefore the calling thread will hang due to usage of
	NutEventBroadcast which will not ‘store’ the signaled state.
	This condition can e.g. occur when attempting connection an
	unconnected target port on an active host. The returning RST would
	be processed and signaled before the NutEventWait is called.

2005-03-25  Michael Jones <Michael.e.Jones@web.de>

	* pro/dhcpc.c: Removed small typo that stopped the DHCPST_REBOOTING state
	from releasing a previously reserved IP-Address if the DHCP server
	sends an NAK.

2005-03-21  Matthias Ringwald <mringwal@.inf.ethz.ch>

	* configure, include/unidst.h: added creation of include/unistd_orig.h
	Added NUT_ wrapper for nut's unistd.h functions. Use <unistd_orig.h>
	instead of "/usr/include/unistd.h". Relevant for unix emulation only.

	* Makefile: added Bernado Innocenti's patches to compile unix c++

2005-03-13  Harald Kipp  <harald.kipp@egnite.de>

	* net/arpcache.c: If NutArpOutput() failed, then NutArpCacheQuery()
	released the already released NETBUF. This bug had been fixed.
	If NutArpAllocNetBuf() fails, the ARP entry will now be
	removed immediately. Additional check for valid entry pointer 
	added. These modifications had been suggested by Dusan Ferbas.
	Finally memcpy() has been replaced by a simple loop in order
	to provide a work around for GCC Bug #18251.


2005-03-09  Henrik Maier  <hwmaier@users.sourceforge.net>

        * os/arch/avr_timer.c: Finally implemented the correct timer routines
        and init for AT90CAN128. Timer2 is now used on AT90CAN128 rather
        Timer0 because Atmel (don't blame me) swapped the Timer designation.


2005-03-04  Ole Reinhardt  <ole.reinhardt@embedded-it.de>
	* dev/adc.c; include/dev/adc.h
	Added function void ADCStartLowNoiseConversion(void)
	This function enters sleep mode!!! Be shure to read
	the AVR datasheet before using this function
	Only implemented on avr_gcc

2005-02-26  Oliver Schulz  <olischulz@web.de>

	* os/arch/avr_nutinit.c: Moved heap initialization to section .init5 to
	support c++ constructors for static objects.

	* tools/nutconf/nutcomponent.c: Added support for relative paths for sample
	application directory.


2005-02-23 Matthias Ringwald <mringwal@.inf.ethz.ch>

	* include/unistd.h: Correctly include /usr/include/unistd.h for
	unix emulation

2005-02-23  Henrik Maier  <hwmaier@users.sourceforge.net>

        * app/basemon/basemon.c: Some minor changes to support AT90CAN128 MCU

        * app/basemon/realtek.c, app/basemon/xmemtest.c:
        Changes in order to support AT90CAN128 with it's different register
        structure, changed "ifdef __AVR_ATmega128__" to
        "#ifdef __AVR_ENHANCED__" so the condition also includes AT90CAN128.

        * app/pppc/pppc.c:
        Changed "ifdef __AVR_ATmega128__" to "#ifdef __AVR_ENHANCED__" so the
        condition also includes AT90CAN128.


2005-02-22 Matthias Ringwald <mringwal@.inf.ethz.ch>

	* include/arch/avr.h: Added cpp test to guess avr-libc-version required
	to specify twi.h include path.
	
2005-02-22  Ole Reinhardt <ole.reinhardt@embedded-it.de>

	* os/tracer.c
        Changed "#if defined(__AVR_ATmega128__) || defined(__AVR_ATmega103__) || ..."
        to a more generic "#if defined(__AVR__)"


2005-02-22  Henrik Maier  <hwmaier@users.sourceforge.net>

        * app/Makeburn.avr-uisp-stk500: Replaced hardcoded processor definition
        with MCU definition to allow burning of AT90CAN128 once it is supported
        by uisp.

        * app/Makeburn.avr-jtagice, app/Makeburn.avr-jtagicemkii: Added to
        support Atmel JTAGICE programmers (Windows only, as Atmel provides
        only Windows tools)

        * app/httpd/httpserv.c:
        Changed "#if defined(__AVR_ATmega128__) || defined(__AVR_ATmega103__)"
        to a more generic "#if defined(__AVR__)" in order to support
        AT90CAN128 device as well.


2005-02-21 Philipp Blum <blum@tik.ee.ethz.ch>

        * dev/usartavr.c, include/sys/atom.h, include/sys/tracer.h,
        os/event.c, os/thread.c, os/timer.c, os/tracer.c, os/arch/avr_timer.c
        Removed tabs and added semicolons after NUTTRACER macros

2005-02-21  Ole Reinhardt <ole.reinhardt@embedded-it.de>
	* os/tracer.c
	Added #if defined(...) statement to compile only on avr-gcc
	platform (fixed compile bug for unix emulation)

2005-02-21  Ole Reinhardt <ole.reinhardt@embedded-it.de>
	* fs/pnutfs.c
	Changed declaration of the "root" variable to compile with
	unix emulation

	* include/unistd.h
	For unix plattforms I added #include "/usr/include/unistd.h"
	since some functions needed for unix_nutinit.c are missing in this
	file...

2005-02-21  Henrik Maier  <hwmaier@users.sourceforge.net>

        * conf/arch/arch.nut: Fixed makedefs MCU definition for AT90CAN128

        * conf/dev/dev.nut: New CAN int vectors ivect35.c and ivect36 added,
        removed "makedefs" entry for RTL_IRQ_RISING_EDGE. Wasn't causing
        trouble with nutconf 1.0.4 but it does with the 1.1.2 version.

        * os/thread.c:
        Changed "#if defined(__AVR_ATmega128__) || defined(__AVR_ATmega103__)"
        to a more generic "#if defined(__AVR__)" in order to support
        AT90CAN128, ATMEGA64, and possibly the ATMEGA256 as well.


2005-02-17 Matthias Ringwald <mringwal@.inf.ethz.ch>

	* os/arch/unix_options.c, os/arch/unix_nutinit: added #include <getopt.h>

2005-02-17  Philipp Blum <blum@tik.ee.ethz.ch>, Matthias Ringwald

	* os/thread.c, include/sys/thread.h: Removed volatile declarations of
	runQueue since it is not touched from interrupt context.
	Same for nutThreadList, runningThread and killedThreads.	

	* os/thread.c: As runQueue is not modified by interrupts,
	runningThread == runQueue always. Therefore removed obsolete
	comparison in NutThreadYield().

	* os/thread.c: Removed unnecessary critical section in NutThreadYield.
	Put NutThreadSwitch call of NutThreadResume into critical section.

	* os/event.c: In NutEventWait(), replaced NutThreadRemoveQueue by
	direct removal of first thread in queue.
	
2005-02-16  Harald Kipp  <harald.kipp@egnite.de>

	* os/event.c, os/thread.c, os/timer.c, os/arch/avr_thread.c,
	include/sys/thread.h: Introduced a new queue in the kernel.
	This may currently break any non-AVR port!
	Instead of inserting a woken-up thread to the priority ordered
	queue of ready-to-run threads, it will be added to the new
	simple linked list of threads waiting to become ready.
	This results in a more deterministic execution time of
	NutEventPostFromIrq(), which is running in interrupt context.
	As a side effect, interrupts do not change the runQueue
	anymore, which in turn allows much tighter critical
	sections.
	All threads collected in the new queue will be moved to the
	ready-to-run queue, when the currently running thread is
	willing to release the CPU. Thus, the non-deterministic
	task of modifify a priority ordered queue has been moved
	from interrupt context to application context, which reduces
	overall interrupt latency.
	Remark: This is the first step towards guaranteed real-time
	response, which is independant of the number of running threads
	or timers. In a second step, a new timer handling will have
	to be implemented.
	Many thanks to Matthias Ringwald and Philipp Blum for their
	stimulating thoughts and discussions.

	* conf/os/os.nut, dev/usart0avr.c, include/sys/atom.h:
	Typo of NUTDEBUG corrected and Philipp Blum's tracer added
	(AVRGCC only).

	* os/arch/avr_thread.c: Added attribute 'naked' to the declaration
	for NutThreadSwitch. Without this attribute GCC may introduced
	some harmful prologue and epilogue code. Thanks to Pete Allinson.


2005-02-10  Henrik Maier  <hwmaier@users.sourceforge.net>

        * configure: Added Cygwin platform and ATMEGA128 CPU

        * net/confnet.c NutNetLoadConfig and NutNetSaveConfig are disabled
        for the AT90CAN128 device as the EEPROM routines are not yet supported
        in avr-libc v1.2 and earlier.
        Refer to: http://lists.gnu.org/archive/html/avr-libc-dev/2004-04/msg00108.html

        * dev/ivect18.c, dev/ivect19.c, dev/ivect20.c, dev/ivect22.c,
        dev/ivect24.c, dev/ivect25.c, dev/ivect26.c, dev/ivect27.c,
        dev/ivect28.c, dev/ivect29.c, dev/ivect30.c, dev/ivect31.c,
        dev/ivect32.c, dev/ivect33.c, dev/ivect34.c:
        Changed test for __AVR_ATmega128__ to a test for the definition of the
        interrupt signal name (GCC) or interrupt vector number (ICC)
        to allow compilation for AT90CAN128.

        * dev/ivect35.c, dev/ivect36.c, dev/Makefile: New files added w/
        interupt handler for AT90CAN128 CAN interupts.

        * include/dev/irqreg.h: Obsolete IRQ enumeration removed. Added CAN
        interrupts for AT90CAN128.

        * include/avr.h: Added some compatibility definitions to support
        AT90CAN128. At this stage only for GCC. ICC still needs work here.

        * os/arch/avr_nutinit.c: Various changes in order to support AT90CAN128
        with it's different register structure.

        * os/avr/thread.c: Removed conditional compilation of
        NutThreadEntry for __AVR_ATmega128__ and __AVR_ATmega103__ as this
        code section is also valid for other supported AVR MCUs.

        * dev/ide.c: Changes to compile for AT90CAN128 MCU.

        * dev/ide.c, dev/wlandrv.c: Removed dependency from
        include/dev/irqreg.h's IRQ enumeration. Using now INTx definition
        instead of irqreg.h's IRQ_INTx.

        * dev/irqreq.c, include/dev/irqreg.h, include/dev/debug.h,
        include/compiler.h, sys/atom.h, sys/types.h, sys/nut_types.h,
        os/nutinit.c, os/timer.c, os/thread.c, include/arch/avr.h,
        sys/nutconfig.h:
        Changed "#if defined(__AVR_ATmega128__) || defined(__AVR_ATmega103__)"
        to a more generic "#if defined(__AVR__)" in order to support
        AT90CAN128, ATMEGA64, and possibly the ATMEGA256 as well.

        * dev/adhdlc.c, dev/debug.h, dev/ide.c, dev/nicrtl.c, dev/twif.c,
        dev/uartavr.c, dev/usart0avr.c, dev/usart1avr.c, dev/usartavr.c,
        include/arch/avr.h, include/dev/debug.h, include/dev/uartavr.h,
        include/dev/usartavr.h, os/arch/timer.c, dev/debug1.c, dev/ide.c,
        os/arch/avr_timer.c:
        Changed "ifdef __AVR_ATmega128__" to "#ifdef __AVR_ENHANCED__" so the
        condition also includes AT90CAN128 and ATMEGA64.


2005-02-08  Ole Reinhardt <ole.reinhardt@embedded-it.de>

	* os/arch/avr-nutinit.c
	Changed waitstate settings in the manner that the lower
	sector still use one waitstate (only for NUT_3WAITSTATES)

2005-02-04  Harald Kipp  <harald.kipp@egnite.de>

	* include/cfg/dhcp.h: Added missing file for compiling in the
	source tree.

	* net/arpcache.c: A few problems solved, thanks to Dusam Ferbas
	and Rostislav Hlebak. Check for completed entry and generating a
	request had been in wrong order, producing one additional
	request. After further looking into the code, it became obvious,
	that this is one of the oldest parts from the very beginning
	of Nut/OS. Several volatile attributes had been left over from
	the days when outdated ARP entries were removed in interrupt
	context. Later, the interrupt handling had been replaced by
	a thread. I decided to remove this thread to save a lot of RAM.
	ARP cache aging is now processed before each incoming and
	outgoing packet.

	* include/cfg/arp.h, conf/net/net.nut: ARP configuration added.

	* net/tcpsm.c: Unused include files removed.

	* net/tcpsock.c: Minor performance fix. NutTcpFindSocket()
	didn't stop on the first listening socket, but always parsed
	the complete list. Now the socket list isn't nicely sorted
	anymore, but that's acceptable.


2005-02-03  Harald Kipp  <harald.kipp@egnite.de>

	* pro/dhcpc.c, include/pro/dhcp.c: Several bug fixes and
	enhancements. The most important fix will avoid hanging, when
	Ethernut is reset while ICMP pings are received. A large number
	of changes make the client to follow RFC 2131 more closely,
	like maintaining renewal and rebind time. Two new API calls,
	NutDhcpStatus() and NutDhcpError(), allow to query the current
	status of the DHCP client. The previously introduced API call
	NutDhcpIsConfigured() has been marked deprecated. Another
	problem was with timeout, because the client continued
	negotiation with the server after the timeout time given in the
	API called elapsed. Now all internal timeouts are adjusted to
	the API timeout. Furthermore the previous version let the
	client continue on fatal errors like UDP receive or UDP
	broadcast failures. Now the client stops on such errors and
	informs the caller. Finally the documentation has been enhanced.


2005-02-02  Harald Kipp  <harald.kipp@egnite.de>

	* conf/pro/pro.nut: DHCP configuration added.

	* net/udpin.c: Do not wake up waiting threads if the incoming
	datagram doesn't fit in the buffer.

	* doc/gen/nutfoot.html: Number of year updated.

	* doc/gen/nut_en.cfg: Upgraded to Doxygen 1.4.1.

	* conf/dev/dev.nut, conf/ethernut13g.conf, include/cfg/arch/avr.h,
	include/cfg/arch/avrpio.h: Port configuration was completely
	broken, because no AVRPORT values had been left undefined for the
	preprocessor. To fix this without modifying too many sourcefiles,
	the name of AVR port config file changed and this new file is
	included by the old cfg/arch/avr.h. However, this may break
	your exisiting code. If you are using a modified version of
	cfg/arch/avr.h, please move all definitions to cfg/arch/avrpio.h.
	If you're using your own configuration files for the Configurator,
	make sure that all items are still correctly configured.
	Specially configured port names may disappear, because most
	names changed from SOME_PORT to SOME_AVRPORT. Sorry for the
	inconvenience caused by this confusing port modification chaos.

	* dev/lanc111.c: If no Ethernet link was available on the LAN91C111,
	each outgoing packet took 15 seconds and, even worse, the ouput
	routine doesn't return an error. Now the first attempt to send a
	packet without Ethernet link will wait 5 seconds for the link to
	come up again and, if this fails, subsequent attempts will take
	0.5 seconds only, always returning an error.

	* dev/spidigio.c: Corrected a typo. Due to the port configuration
	problem, this and the resulting compile error wasn't detected.


2005-01-26  Matthias Ringwald <mringwal@inf.ethz.ch>
	
	* os/tracer.c, include/sys/tracer.h: fixed includes
	and prototypes

2005-01-21  Matthias Ringwald <mringwal@inf.ethz.ch>
	
	* os/tracer.c, include/sys/tracer.h: new tracer for
	profiling of nut/os and app functions by Philipp Blum
	
	* dev/usart0avr.c, dev/usart1avr.c, dev/usartavr.c,
	include/sys/atom.h, os/arch/avr_timer.c, os/event.c,
	thread.c, timer.c: enable profiling of AvrUsartTxEmpty,
	AvrUsartRxComplete, NutEnterCritical, NutExitCritical,
	NutTimer0Intr, NutEventWait, NutThreadYield, NutThreadSetPriority,
	NutSleep

2005-01-22  Harald Kipp  <harald.kipp@egnite.de>

	* Makefile, Makedefs.avr-gcc, conf/cpp/cpp.nut,
	conf/repository.nut, conf/tools.nut, include/cpp/nutcpp.h:
	Added C++ patches contributed by Oliver Schulz (MPI). The
	file nutcpp.h must be included by C++ applications. We got
	a real problem now, because this is not the same Oliver Schulz
	we know from several previous contributions. I'll add MPI to
	his name, because he's currently working at the Max Planck
	Institute of Molecular Physiology in Dortmund.

	* app/cppdemo/cppdemo.cc, app/cppdemo/Makefile: Not yet
	documented very well, but it proofs that C++ is available
	to Nut/OS applications.

	* app/Makedefs.avr-icc: Compiling applications with external
	RAM for variable space didn't work when using ICCAVR on the
	command line. This fixes it.

	* arch/avr/init/crtnut.s, arch/avr/init/crtnutram.s,
	arch/avr/init/init.s: Upgraded to the latest ICCAVR V6
	release.

	* arch/avr/init/crtenut.s, arch/avr/init/crtenutram.s,
	arch/avr/init/ethini.s, conf/arch/arch.nut: Fixes external
	memory problems for ICCAVR and Ethernut 1.3 Rev-G. The
	RTL8019AS is now initialized early.

	* os/arch/avr_nutinit.c: Fixes the same external memory
	problems on Ethernut 1.3 Rev-G for GCC.

	* conf/repository.nut, conf/dev/dev.nut, dev/lanc111.c,
	dev/nicrtl.c, dev/spidigio.c, dev/usart0avr.c, dev/usart1avr.c,
	include/cfg/arch/avr.h:
	Changed AVR port configuration names from PORTx to AVRPORTx.
	Now the preprocessor is able to handle port related
	expressions even after avr/io.h has been included.

	* dev/uartspi.c, dev/uarts.c, dev/Makefile, conf/dev/dev.nut:
	Removed uartspi devices. No one uses them any more.

	* cfg/coconut.h, cfg/ethernut.h, cfg/modem.h: Marked
	deprecated.

	* os/nutinit.c: My assumption on moving the ms62_5 counter
	from timer.c to nutinit.c to keep it in AVR's internal memory
	was wrong. However, in most cases applications consume RAM by
	large uninitialized arrays. Explicitly initializing ms62_5 will
	help in most cases.


2005-01-21  Matthias Ringwald <mringwal@inf.ethz.ch>

	* os/event.c: NutEventPostAsync -> NutEventPostFromIrq,
	new NutEventPostAsync with build-in critical section.

	* include/sys/event.h os/event.c dev/sja1000.c dev/ahdlcavr.c
	dev/ide.c dev/lanc111.c dev/nicrtl.c dev/nicrtl_h8.c dev/scih8.c
	dev/twif.c dev/uartavr.c dev/uartspi.c dev/unix_devs.c dev/usartavr.c
	dev/wlandrv.c net/tcpsm.c os/arch/unix_nutinit.c os/msg.c:
	Renamed calls from IRQs to NutEvenPostAsync into NutEventPostFromIrq,
	removed Critcal Sections around calls to NutEventPostAsync

2005-01-19  Matthias Ringwald <mringwal@inf.ethz.ch>

	* stdio.h, stdio_nut_wrapper.h, time.h: more fixes
	for cygwin compilation

	* timer.h, timer.c, event.c, msg.c: Made critical section
	of NuTimerStart shorter. Extracted ms to ticks
	conversion out of NutTimerStart as NutTimerMillisToTicks.
	Extra function NutTimerStartTicks. Adapted NutSleep
	and NutMsgQTimerCb to take benefit of this.
 	Improved critical section in NutEventPost.

2005-01-19  Matthias Ringwald <mringwal@inf.ethz.ch>

	* unix_devs.c: added includes for cygwin compile.
	Implemented input flush (read with len = 0).

2005-01-13  Harald Kipp  <harald.kipp@egnite.de>

	* conf/net/net.nut: Added dependencies to avoid compilation
	of network parts for targets without network hardware.

	* net/netdebug.c: Removed type casts from previously converted
	printf formats to avoid compiler warnings.

	* os/timer.c, os/nutinit.c: Moved ms62_5 counter from timer.c
	to nutinit.c. On AVR platforms this makes sure, that the
	variable is located in internal RAM, because nutinit.c is
	the first module being linked. This fixes the wrong baudrate
	bug for applications occupying all internal RAM. Not nice,
	but works. In addition some timer handling had been optimized.
	The volatile attribute of a pointer in NutTimerInsert() wasn't
	really required and had been removed. In NutTimerStop() the
	critical section had been reduced to improve interrupt
	performance of the whole system. More could be done here.


2005-01-10  Ole Reinhardt <ole.reinhardt@embedded-it.de>

	* include/arch/avr.h
	Included check if atof is just defined (needed by
	new avr-libc versions on debian unstable)


2005-01-02  Harald Kipp  <harald.kipp@egnite.de>

	* net/tcpsm.c: Replaced unprotected calls to NutEventPostAsync()
	by late calls to NutEventPost(). This should fix the infrequent
	system halts/resets. The event to the transmitter waiting queue
	will be broadcasted on relevant state changes. Finally I added
	some more comments to the code.

	* net/tcpsock.c: Simplyfied NutTcpSend().


2005-01-02  Harald Kipp  <harald.kipp@egnite.de>

	* net/netdebug.c, os/event.c, os/thread.c, os/timer.c:
	Replaced platform dependant formats in debug outputs.


2004-12-31  Oliver Schulz  <olischulz@web.de>

	* pro/dhcpc.c, include/pro/dhcp.h: Bugfixes from Michel Hendriks applied:
	Allocate empty dyncfg's to prevent freeing twice of domain/hostname, Clear
	pointer after ReleaseDynCfg to prevent freeing twice, Make sure SelectOffer
	is never called with 0 offers, When falling back from rebooting to
	selecting, clear the received ip address so NutDhcpIfConfig does not assume
	it has been configured properly.


2004-12-17  Harald Kipp  <harald.kipp@egnite.de>

	* net/route.c, include/net/route.h: Added Adam Pierce's
	routing management functions.

	* os/bankmem.c: Bugfix. Comparison of the read and write
	pointers now includes the segments. Thanks to Pete Allinson
	and Johan van der Stoel.

	* dev/nicrtl.c, conf/dev/dev.nut: Support of rising edge
	interrupts for hardware w/o inverter gate. Fixed compilation
	issue for hardware with RTL reset port. Thanks to
	FOCUS Software Engineering Pty Ltd.

	* conf/xnut-100.conf: proconX XNUT-100 board added.


2004-12-16  Harald Kipp  <harald.kipp@egnite.de>

	* dev/ahdlcavr.c, dev/twif.c, dev/uartavr.c,
	os/arch/avr_timer.c: Late increment fixes ICCAVR bug.
	Thanks to Andreas Siebert and Michael Fischer.
	
	* conf/charon2.conf: Configuration for Charon II added.

	* pro/httpd.c, include/pro/httpd.h: Added Mikael Adolfsson's
	excellent parameter parsing routines. (Mikael, sorry for
	the delay.)

	* app/httpd/httpserv.c: Form handling uses Mikael's
	NutHttpGetParameter routines. Provided by Michael Fischer.

	* net/ipin.c, include/netinet/ip.h: Added Damian Slee's
	IP filter function.


2004-11-29  Matthias Ringwald <mringwal@inf.ethz.ch>

    * include/stdio.h, include/stdio_nut_wrapper.h, include/time.h,
    dev/unix_devs.c: some fixed to get core nut/os compiled on cygwin
    hint: add -D__linux__ to Makedefs after configuration

    * dev/unix_devs.c: no support for speed > 230400 on cygwin

    * os/arch/unix_thread.c: added return to make a compiler happy

2004-11-29  Matthias Ringwald <mringwal@inf.ethz.ch>

    * include/stdio.h, include/stdio_nut_wrapper.h, include/time.h,
    dev/unix_devs.c: some fixed to get core nut/os compiled on cygwin
    hint: add -D__linux__ to Makedefs after configuration

    * dev/unix_devs.c: no support for speed > 230400 on cygwin

    * os/arch/unix_thread.c: added return to make a compiler happy

2004-11-24  Harald Kipp  <harald.kipp@egnite.de>

	* tools/nutconf/nutcomponent.c, tools/nutconf/nutconf.cpp,
	tools/nutconf/nutconf.h, tools/nutconf/valuewindow.cpp,
	tools/nutconf/nutconfdoc.cpp: Release 1.1.1. Do not store
	empty options. Remove include files from the build tree,
	if they are no longer used. Command line parameter 's'
	allows different settings. Minor compiler warning fixed.

	* conf/stk501.conf: Configuration for Atmel's STK501 board
	added.

	* conf/crt/crt.nut, crt/getf.c, crt/putf.c: Floating point
	working again. putff.c, getff.c and libnutcrtf.a are unused
	but kept a while for backward compatibility. Configuration
	of max. number of streams added.

	* conf/dev/dev.nut: Advanced descriptions. Ole's memory
	mapped LCD driver, CAN Bus driver and ADC routines added.
	Chat options added.

	* include/dev/chat.h: Configurable chat options.

	* conf/os/os.nut: EEPROM location no more required in
	.conf files. The problem is, that we can't have empty
	integer values, so I added flavor 'booldata' to disable
	this item.

	* conf/repository.nut: Added empty strings to choice
	arrays. This enables creation of empty items, which
	are not added to the .conf files.

	* include/arch/gba.h, include/cfg/chat.h:
	Placeholders added.

	* app/Makeburn.gba-xport2: Programming support for
	Xport 2.0.

	* During commit I mistyped the command. CVS is too
	tolerant and some log messages in the conf directory
	are spoiled. Grrrrrr....

	* app/uart/uart.c: Include cfg/crt.h for floating point
	support.

	* include/sys/syslog.h: Prototype declarations for
	Harvard architecture corrected.


2004-11-11  Ole Reinhardt
	* dev/sja1000.c
	Added critical section around NutEventPostAsync

2004-11-08  Oliver Schulz  <olischulz@web.de>

	* Makerules.arm-gcc, Makerules.avr-gcc, */Makefile: Added rule to clean up
	intermediate gcc files (*.i)

	* tools/nutconf/nutconfdoc.cpp: While creating the sample directory, CVS
	files are now not copied.


2004-11-08  Harald Kipp  <harald.kipp@egnite.de>

	* Makedefs.arm-gcc, app/Makedefs.arm-gcc: Generating code
	that works with mixed arm and thumb mode (interwork). Usage
	of frame pointer disabled. No idea why, but it failed on
	the Gameboy when code uses a frame pointer register.

	* arch/arm/init/crtgbaxport2.S: Interrupt handling
	removed. It didn't work, didn't even compile without
	modification. GBA interrupt support is still a hack.

	* dev/debug_gba.c: Now supports carriage return.

	* dev/twif.c: Several fixes, don't ask me about details.
	I'm really fed up with this. But we've got four ATmegas
	running Nut/OS in multimaster mode for days without
	problem.

	* include/dev/usart.h: Changed rbf_head, rbf_tail and
	rbf_cnt in the RINGBUFF structure to volatile, because
	they are modified by the interrupt routines.

	* os/heap.c: Allocated sizes are adjusted to 32-bit
	boundaries. I know this is botch. We need something
	more general to configure alignment.

	* conf/*.conf, conf/os/os.nut, include/cfg/os.h,
	os/arch/arm_nutinit.c, os/arch/avr_nutinit.c,
	os/arch/h8_nutinit.c, os/arch/unix_nutinit.c:
	Stack size of idle and main thread is now configurable.

	* os/arch/arm_timer.c: Hacked in Gameboy timer support.

	* os/arch/arm_thread.c: Made assembly includes look
	nice (and independent from embedded tabs). Changed
	mode from supervisory to user supervisory, which
	seems to work with the GBA. Skipped entry frame,
	because it simply confuses me. :-) Finally Nut/OS
	is now running on my GBA SP.


2004-10-14  Oliver Schulz  <olischulz@web.de>

	* crt/localtim.c, crt/gmtime.c, dev/usart.c, dev/wlandrv.c, pro/resolv.c:
	Fixed compiler warning "comparison between signed and unsigned"


2004-10-14  Ole Reinhardt <ole.reinhardt@kernelconcepts.de>

        * dev/hd44780_bus.c: Added default LCD config to avoid compiling
	  error if no LCD type is defined.


2004-10-10  Oliver Schulz  <olischulz@web.de>

	* net/route.c: Removed unneccessary call to NutIpRouteRecQuery.

	* net/ipout.c: Now directed broadcasts to the local network are detected,
	and no ARP queries are sent.


2004-10-03  Harald Kipp  <harald.kipp@egnite.de>

	* doc/gen/nut_en.cfg, os/version.c: Set to 3.9.2.

	* conf/arch/arch.nut, conf/repository.nut, conf/tools.nut,
	dev/irqreg.c, arch/arm/init/crtgbaxport2.S,
	arch/arm/ldscripts/gbaxport2.ld, conf/gbaxport2.conf:
	Added Nintendo Game Boy Advance with Xport 2.0 from Charmed Labs.

	* conf/dev/dev.nut, include/dev/debug.h, debug_gba.c:
	Added GBA debug device and made UART SPI dependent from
	HW_MCU_AVR.

	* dev/usart1avr.c: Set base address to 1, so drivers are
	able to distinguish UART0 from UART1.

	* pro/syslog.c, include/sys/syslog.h: Harvard architecture
	calls added.

	* os/arch/arm_timer.c: No GBA timer yet, but made it
	compilable.


2004-09-26  Oliver Schulz  <olischulz@web.de>

	* tools/nutconf/nutconf.cpp, tools/nutconf/nutcomponent.c,
	tools/nutconf/nutcomponent.h, tools/nutconf/nutconfdoc.cpp: Fixed several
	hundred memory leaks :-). Relative pathes can now be used for source, build
	and install directory, but doesn't work for samples yet.


2004-09-25  Oliver Schulz  <olischulz@web.de>

	* conf/dev/dev.nut: Light change for separate interrupt stack. Now it depends
	also on macro HW_MCU_AVR.

	* conf/os/os.nut: Removed configuration for separate interrupt stack, it's now
	in conf/dev/dev.nut


2004-09-22  Harald Kipp  <harald.kipp@egnite.de>

	* conf/arch/arch.nut, conf/dev/dev.nut, dev/lanc111.c:
	LAN91C111 driver is configurable, but no ATmega103
	support. Does anybody need this?
	List of devices sorted by platform.

	* conf/dev/dev.nut, dev/irqstack.c, include/dev/irqstack.h,
	os/arch/avr_thread.c: Separate IRQ stack for AVR is
	configurable.

	* conf/dev/dev.nut, dev/spidigio.c: Configurable ports
	for digital I/O shift register.

	* conf/dev/dev.nut, dev/usart0avr.c, dev/usart0avr.c:
	Configurable handshake ports.


2004-09-19  Harald Kipp  <harald.kipp@egnite.de>

	* app/logtime/logtime.c, app/logtime/Makefile: New application
	demonstrates usage of syslog and SNTP.

	* include/sys/syslog.h, pro/syslog.c, pro/Makefile,
	conf/pro/pro.nut: Syslog protocol added.

	* include/cfg/arch.h, include/cfg/crt.h, include/cfg/eeprom.h,
	include/cfg/os.h, include/cfg/syslog.h: Configuration
	placeholders for building in source tree.

	* arch/arm/init/crteb40a_ram.S, arch/arm/ldscripts/eb40a_ram.ld,
	arch/arm/ldscripts/s3c4510b_ram.ld, arch/Makefile:
	ARM7 initialization.

	* arch/avr/init/area.s, arch/avr/init/crtnut.s,
	arch/avr/init/crtnutram.s, arch/avr/init/extram.s,
	arch/avr/init/init.s, Makedefs.avr-icc, Makerules.avr-icc,
	conf/arch/arch.nut: ICCAVR initialization added to build.

	* tools/nutconf/nutcomponent.c: Bugfix. More than one target
	in a single component created wrong list, which failed with
	'make install'.

	* tools/nutconf/nutconfdoc.cpp: Bugfix. Modifying anything
	else but checkboxes didn't enable the toolbar's save button.


2004-09-17  Ole Reinhardt <ole.reinhardt@kernelconcepts.de>
	* dev/hd44780_bus, dev/sja1000.c
	Added #ifdef __GNUC__ statement since both drivers are not ported
	to icc by now... Anybody wants to port them

2004-09-17  Harald Kipp  <harald.kipp@egnite.de>

	* tools/nutconf/Makefile: Ole removed tooloptdlg.o, which
	was correct to get it compiled. But the real problem was,
	that I forget to commit all changes. So tooloptdlg.o
	has been added again.

	* tools/nutconf/tooloptdlg.cpp, tools/nutconf/tooloptdlg.h,
	tools/nutconf/nutconf.cpp, tools/nutconf/settings.cpp,
	tools/nutconf/settings.h, tools/nutconf/settingsdlg.cpp,
	tools/nutconf/settingsdlg.h: New settings page for tool
	options added.

	* tools/nutconf/nutcomponent.c, tools/nutconf/nutcomponent.h,
	tools/nutconf/nutconfdoc.cpp:
	INCFIRST and INCLAST definitions added to application sample
	directory building.


2004-09-16  Ole Reinhardt <ole.reinhardt@kernelconcepts.de>
	* os/Makefile
	Changed position of LIBDIR to support correct install directory for
	nutinit.o and libnutos.a

2004-09-12  Harald Kipp  <harald.kipp@egnite.de>

	* doc/gen/nut_en.cfg: Updated version and using default
	installation path.

	* doc/gen/nutdoc_en.txt: Old history, stream and init
	removed. Version updated.

	* tools/crurom/Makefile: Target install added.

	* tools/nutconf/Makefile: Target install and tooloptdlg.o
	added.

	* tools/packaging/ethernut-3.9-1.spec: RPM spec file
	added.


2004-09-10  Harald Kipp  <harald.kipp@egnite.de>

	* eboot/ether.c: Added minimal "EEPROM emulation" to support
	Ethernut 1.3 Rev-G boards. To squeeze it again in 4kByte,
	the broadcast, gateway and dns had been removed.

	* Makedefs.avr-icc, Makerules.avr-icc, app/Makedefs.avr-icc,
	app/Makerules.avr-icc: Replaces .icc files.

	* app/Makedefs.avr-gcc, app/Makerules.avr-gcc: Replaces
	.gcc files.

	* app/rs232d/rs232d.c: Removed old header files.

	* app/threads/Makefile: Undefined references solved by
	second pass for libnutos.

	* app/threads/threads.c: Replaced devUart0 by devUsartAvr0.

	* app/uart/Makefile, app/uart/uart.c: Floating point
	configuration broken. Temporarly removed.

	* dev/nicrtl.c: ICCAVR compile problems fixed.

	* Makedefs.avr-gcc, Makefile, app/Makedefs.avr-gcc,
	crt/Makefile, dev/Makefile, fs/Makefile, net/Makefile,
	os/Makefile, pro/Makefile: Old method of building the
	system within the source dir works again for AVR. We
	keep this as a backup method.


2004-09-08  Harald Kipp  <harald.kipp@egnite.de>

	* os/version.c: Although this is no final release, there
	is a lot of new hardware waiting for Nut/OS support. So
	I marked this with version 3.9.1 before creating the
	long awaited 4.0 branch.

	* Makedefs.arm-gcc, Makerules.arm-gcc: Reduced to what we
	really need.

	* Makedefs.avr-gcc: Remove directory part from listing
	files to keep the source directory clean.

	* nut/Makerules.avr-gcc: Assembler rule added.

	* nut/app/Makedefs.avr-dude, nut/app/Makeburn.avr-uisp-stk500:
	Programmer configuration files added. Frankly, I'm not happy
	with this solution. Any better ideas for programmer
	configuration?

	* app/isp2/Makefile: *nix requires dot-slash for local
	include directory.

	* app/simple/Makefile, app/threads/Makefile: Add configurable
	library list.

	* app/threads/threads.cpp: Added support for EB40A. This is
	our first example running on that board.

	* app/timers/timers.cpp: Added support for EB40A, but still
	not working. :-(

	* c/stdlib/*, c/string/*: Minimal standard C library added,
	using some BSD code. There are a lot of libraries available,
	but many of them are not really OS independent.

	* conf/arch/arch.nut: Enable C startup for ARM platforms
	only.

	* crt/fclose.c, crt/freopen.c, include/arch/arm.h: RAMSTART
	check removed. In fact we need to check the stream for stdio,
	so this is now wrong. But RAMSTART is too hardware dependent.
	For now it is not possible to close stdio streams.

	* crt/malloc.c, nut/os/devreg.c: RAMSTART check removed. Buggy
	AVR applications may now crash when freeing unallocated
	memory.

	* dev/arm_irqreg.c, include/dev/irqreg_arm.h,
	dev/s3c4510b_console.c, dev/s3c4510b_irqreg.c,
	dev/uart_s3c4510b_dbg.c: SAMSUNG S3C45 support added, but not
	fully working yet.

	* dev/twif.c: Too lazy to list all fixes. :-) Many thanks to
	all the unnamed contributors.

	* include/arch/at91.h, include/arch/at91eb40a.h: Hardware
	definitions for new ARM7 support.

	* dev/debug_at91.c, include/dev/debug.h: Device devDebug1
	added for ARM7. This is the only device for this CPU so far.

	* os/arch/arm_nutinit.c: Using configurable NUTMEM_SIZE
	and __heap_start from linker script. Looks like all platform
	dependancies can be removed from NutInit?

	* os/arch/arm_thread.c: I took over James Tyou's port for the
	SAMSUNG chip nearly without modifications and it works fine
	with Atmel's ARM7TDMI. Good work!

	* os/arch/arm_timer.c: Added my AT91 timer interrupt, which
	ignores Nut/OS interrupt registration for now. Also included
	is Tyou's SAMSUNG timer initialization, but some more has to
	be done. Please use the full port from Tyou's website until
	then.

	* nut/os/confos.c: No EEPROM support for AT91.

	* nut/os/timer.c: Added OS configuration include file.

	* conf/*.conf: Ethernut configuration files updated.


2004-09-07  Harald Kipp  <harald.kipp@egnite.de>

	* conf/arch/arch.nut: MCU type in NutConf.mk and cstartup
	added.

	* conf/crt/crt.nut: Program space routines moved to specific
	modules.

	* conf/dev/dev.nut: ARM7 IRQ handler removed to get it
	running with the current implementation for EB40A, which
	handles the timer interrupt in arm_timer.c. We will have
	to create a more general interrupt handler for ARMs later.

	* conf/repository.nut: ARM7 linker script choice added.

	* conf/tools.nut: ARM7 linker script and nutlibc configuration
	added.

	* tools/nutconf/configitem.cpp: Boolean items were not
	properly initialized.

	* tools/nutconf/nutcomponent.c: SRCx replaced by OBJx for
	additional modules. Still bumpy with some versions of make.
	Not all subdirs had been created with prior versions.
	-DETHERNUT2 added to any newly created UserConf.mk.

	* tools/nutconf/nutconfdoc.cpp: Configured build dir
	added to library and include paths of sample makefiles.

	* tools/nutconf/settings.cpp: Initial default lib
	directory is now empty.

	* conf/ethernut13f.conf, conf/ethernut13g.conf,
	conf/at91eb40a.conf: New pre-defined hardware configurations.


2004-09-01  Harald Kipp  <harald.kipp@egnite.de>

	* app/basemon/basemon.c, app/basemon/realtek.c: Added support
	for EEPROM emulation.

	* conf/dev/dev.nut: Added UART handshake and EEPROM emulation
	port bits.

	* conf/os/os.nut: Cleaned up memory configuration.

	* conf/repository.nut: AVR interrupts chosen by number.

	* os/arch/avr_nutinit.c: Using configuration values from
	cfg/memory.h. Added configurable reserved memory area.
	Automatic check for external memory removed.


2004-08-26
	* dev/hd44780_bus.c
	Fixed cursor positionion for different devices. Now can set
	four LCD types by defining: KS0073_CONTROLLER, LCD_4x20, LCD_4x16

2004-08-25  Harald Kipp  <harald.kipp@egnite.de>

	* include/cfg/arch/avr.h, include/cfg/arch/avrpio.h:
	New include directory cfg/arch added, which should be used
	for target specific items, mainly port usage or MCU specific
	register settings. Still the top configuration directory
	should be prefered whenever possible. For example, memory
	layout may seem MCU specific, but in this sense it is not.
	Memory addresses are typically board specific.

	* include/cfg/bankmem.h, include/cfg/memory.h: More general
	memory layout definitions moved to the new cfg/memory.h.
	The header file bankmem.h is still kept and may define
	the number of banks to used by a specific function.

	* dev/nicrtl.c: Hardware dependent definitions are
	configurable. For performance reasons the base address is not
	kept in a variable any longer. It is now a preprocessor macro
	and the parameters during device registration are ignored. The
	speed improvements provided by Kolja Waschk for the LAN91C111
	had been implemented here too. The driver will not touch a
	port anymore unless a reset port bit had been configured.
	For Ethernut 1.1 bit 4 PORTE must be specified in the
	configuration. Finally, an EEPROM emulation had been added,
	which can use address bus bits instead of wasting additional
	port pins. The required hardware has been implemented on
	Rev.-G Ethernut 1.3 boards. This fixes the Realtek full
	duplex problem.

	* app/Makedefs.*: Fixed a problem with undefined top_srcdir
	and top_blddir when building applications in the source
	directory.


2004-08-25  Ole Reinhardt <ole.reinhardt@kernelconcepts.de>

	* dev/candev.c, dev/candev.h
	Added function to set acceptance filter

2004-08-18  Harald Kipp  <harald.kipp@egnite.de>

	* os/bankmem.c, include/sys/bankmem.h, include/cfg/bankmem.h:
	Made banked memory configurable.

	* crt/putf.c: Compile error on non-Harvard architecture fixed.

	* app/*/Makefile: Replaced top_srcdir by parent directory to
	allow independent application directories.

	* tools/nutconf, conf/*.nut: Tool is working now on Win32 and
	Linux for avr-gvv.

	* makedefs.avr-gcc, makerules.avr-gcc: Copied from .gcc to have
	a more consistent naming convention. The original files may be
	removed later.


2004-08-11  Matthias Ringwald <mringwal@inf.ethz.ch>
    * dev/unix_devs.c: removed a potential dead lock,
    and now initialized a pthread_mutex before usage

    * doc/gen/nutdoc_en.txt: some docu added for mutex, semaphore
    and the unix emulation

2004-08-09  Matthias Ringwald <mringwal@inf.ethz.ch>
    * dev/unix_devs.c, include/dev/unix_devs.c, include/arch/unix.h:
    added a third uart as devDebug2, devUart2, devUsartAvr2
    for testing in unix emulation

2004-08-05  Oliver Schulz  <olischulz@web.de>

	* crt/filelength.c: For VIRTUALDEVICEs the return value of the ioctl
	function was returned, which is obviosly wrong. Now the correct
	filelength value is returned to the caller.

2004-08-05  Matthias Ringwald <mringwal@inf.ethz.ch>
    * dev/irqreg.h, os/thread.c, os/arch/unix_nutinit.c,
    os/arch/unix_thread.c: added unix emulation hook in NutThreadYield
    to safely process NutPostEventAsync calls occuring in non Nut/OS
    threads.

    * dev/unix_devs.c, include/dev/unix_devs.c: rewrote the unix read
    function again using the new unix NutThreadYield hook to call
    the NutPostEventAsync function safely (fast & correct).
    _write(nf, 0, 0) aka fflush is ignored on unix emulation.

    * dev/unix_devs.c: CTRL-C on terminal terminates running
    unix emulation apps nows.

    * os/nutinit.c, os/arch/unix_eeprom.c, include/arch/unix.h:
    added an avr-libc compatible (but yet uncomplete) eeprom simulation
    that uses file 'eeprom.bin' in the current directory to store eeprom
    content.

2004-08-03  Harald Kipp  <harald.kipp@egnite.de>

	* app/basemon: Dataflash check added. Fixed a bug, which offered MAC
	address 0. This is really weird: The MAC address bug had been fixed
	by making an auto array global. There's probably something wrong
	with the stack. UART initialization is now early for easier debugging.
	In previous releases the web server didn't produce any output when
	Basemon didn't detect RS232 input. This confused users, didn't show
	the IP settings and thus had been changed. All calls to NutDelay had
	been replaced by calls of the local Delay routine. The SMSC shares
	transmit and receive buffer, which let the broadcast test fail after
	some incoming packets, which where never removed from the NIC. Now
	the receiver is disabled during broadcast test and the NIC will be
	reset if running out of buffer space. A more feasible baudrate table
	is used now, which also supports overclocked ATmegas.


2004-08-03  Harald Kipp  <harald.kipp@egnite.de>

	* conf, tools/nutconf: Lots of changes, too many to list here.
	The tool seems to become useful soon, just a few bug fixes
	away from here.


2004-08-02  Ole Reinhardt
    * include/can_dev.h dev/can_dev.c
    Changed typing of CAN_TryRxFrame. Hope this will not concern too much
    people

    * include/adc.h dev/adc.c
    Initial import of an ADC driver for ATMega128 / AVR-GCC

2004-07-30  Oliver Schulz  <olischulz@web.de>

    * include/io.h: First proposal to define some global ioctl commands.

    * crt/filelength.c:  filelength implemented for VIRTUALDEVICEs using the new
    global ioctl command IOCTL_GETFILESIZE.

    * include/netinet/tcp_fsm.h: Added a comment and changed the prototype of
    NutTcpStateRetranTimeout.

    * include/netinet/tcputil.h: Added prototype of new function NutTcpCalcRtt.

    * pro/httpd.c: Slightly improved handling if socket was closed by peer.

    * include/sys/socket.h, include/sys/sock_var.h, net/tcpsock.c, net/tcpout.c,
    net/tcpsm.c, net/tcputil.c: Some code of TCP stack redesigned. Round trip
    time calculation is now supported. Fixed several bugs in TCP state machine.
    Now TCP connections should be more reliable under heavy traffic or poor
    physical connections.


2004-07-27  Oliver Schulz  <olischulz@web.de>

    * crt/strtok_r.c, include/strtok_r.h: Implementation of strtok_r adjusted to
    the POSIX 1c standard. This will just affect the ImageCraft compiler,
    because avrlibc already supplies this function.

    * net/arpcache.c: Under certain circumstances the same ARPENTRY was
    allocated twice.

    * net/arpin.c: If NutArpOutput fails, the NetBuf must not be deallocated by
    calling NutNetBufFree.


2004-07-19  Matthias Ringwald <mringwal@inf.ethz.ch>
    * os/event.c: Fixed NutPostEvent to give up CPU
    if there is another thread ready with same priority.
    to match the documentation
    Also removed 'SWP..' NBUTDEBUG output, as switching
    is done calling NutThreadYield()

2004-07-19  Matthias Ringwald <mringwal@inf.ethz.ch>

    * os/mutex.c: code contained same bug as os/semaphore.c.
    Unfortunately I didn't understand the other fix, but
    anyway made NutMutexLock more robust.
    Fixed wrong indention of all functions

2004-07-14  Matthias Ringwald <mringwal@inf.ethz.ch>

    * dev/unix_devs.c: read operation is now woken by
    a 'IRQ'-handler to avoid race-conditions
    Provide placebo implementations for
    UART_[SET/GET][TX|RX]BUF[SIZ|HWMARK|LWMARK],
    UART_[GET|SET]STATUS and UART_SETCOOKEDMODE ioctl.

    * os/arch/unix-nutinit.c, unix_timer.c, unix.h:
    Provide enumeration for IRQs used so far,
    IRQ dispatcher uses broadcast now,
    added handler for CTRL-C

2004-07-09  Matthias Ringwald <mringwal@inf.ethz.ch>

    * os/arch/avr-nutinit.c: Allow setting of NUTRAMEND
    by giving it as a compiler flag and moved
    ((volatile u_char *) NUTRAMEND) cast into NUTRAMENDPTR

    * os/arch/avr-nutinit.c: New function
    NutThreadSetSleepMode to tell nut/os to set the
    MCU to sleep when in idle (avr-gcc && avr128 only)

2004-06-25  Matthias Ringwald <mringwal@inf.ethz.ch>

    * crt/write.c, crt/write_P.c: Added note that write
    calls are not thread-safe, i.e, two writes might
    come out intermixed

2004-06-24  Matthias Ringwald <mringwal@inf.ethz.ch>

    * dev/unix_devs.c: if using STDIO, better read from
    STDIN instead of STDOUT => unix piping works

2004-06-23  Ole Reinhardt <ole.reinhardt@kernelconcept.de>
    * dev/can_dev.c, include/dev/can_dev.h:
    Added functions for buffer monitoring (avail / free)

2004-06-21  Matthias Ringwald <mringwal@inf.ethz.ch>

    * dev/unix_devs.c: multiple parallel reads now work.
    But still dead-locks possible.
    Non-blocking stdio.

2004-06-21  Matthias Ringwald <mringwal@inf.ethz.ch>

   * os/arch/unix_nutinit.c: idle thread now sleeps until
    the next (virtual) IRQ occures

2004-06-21  Matthias Ringwald <mringwal@inf.ethz.ch>

    * dev/unix_devs.c: read operation is using extra pthread
      to only block current thread (instead of all threads)

2004-06-21  Matthias Ringwald <mringwal@inf.ethz.ch>

    * include/dev/usart.h|uart.h: added device definitions for
      *nix emulation

2004-06-08  Matthias Ringwald <mringwal@inf.ethz.ch>

    * include/sys/types.h: changed #include "types_orig.h" to
    <sys/types_orig.h> to allow this file to be in $MODDIR

2004-06-07  Harald Kipp  <harald.kipp@egnite.de>

	* conf: Still incomplete configuration scripts added.

	* tools/nutconf: Working configuration tool replaced by very
	incomplete re-design. It will read the Lua scripts from the
	conf directory and display an editable tree of configuration
	items.


2004-06-07  Ole Reinhardt  <ole.reinhardt@kernelconcepts.de>
	* dev/sja1000.c, dev/can_dev.c
	  include/dev/sja1000.h, include/dev/can_dev.h
	
	Initial checkin of a driver and a simple api for can-bus devices.
	This driver is for the well known phillips sja1000 wich is connected
	to the Memory bus and an external interrupt.

2004-06-02  Ole Reinhardt  <ole.reinhardt@kernelconcepts.de>
	* os/semaphore.c
	Changed NutEventWait to NutEventWaitNext according to a hint
	from Oliver

2004-06-02  Ole Reinhardt  <ole.reinhardt@kernelconcepts.de>
	* os/semaphore.c, include/sys/semaphore.h
	Fixed a integer overflow (underflow) in semaphore implementation
	Now a Semaphore initialized with 0 can not underrun any longer.

2004-05-26  Ole Reinhardt  <ole.reinhardt@kernelconcepts.de>
	* dev/cs8900.c
	Now compatible with newer AVRGCC versions. Reading of FrameLength
	and ReceiveStatus needs to be done high byte first.
	Added software wakeup and reset to init code (only available
	for new code)

2004-06-07  Harald Kipp  <harald.kipp@egnite.de>

	* conf: Still incomplete configuration scripts added.

	* tools/nutconf: Working configuration tool replaced by very
	incomplete re-design. It will read the Lua scripts from the
	conf directory and display an editable tree of configuration
    items.

2004-05-24  Ole Reinhardt  <ole.reinhardt@kernelconcepts.de>

	* include/dev/hd44780_bus, dev/hd44780_bus
	New driver for memory mappen LCD displays. Take a look into
	hd44780_bus.c for detailed information about hardware design

	* include/dev/term.h, dev/term.h
	Small change to pass base address to LCD driver.

	* include/dev/hd44780.h, dev/hd44780.c
	Small changes to be compatible with newly added hd44780_bus.c driver
	and changed terminal driver

	* os/arch/avr_nutinit.c
	Added option to add 3 waitstates to memory region 0x8000-0xFFFF. You
	can enable this option by defining NUT_3WAITSTATES
	This is needed for some memory mapped io devices. Espacialy for the
	cs8900 driver and hd44780_bus device.

	* dev/cs8900.h, dev/cs8900.c
	
	CHANGED BEHAVIOR:
	By default this driver will now retreive it's MAC Address from
	EEPROM config. Also it will retreive it's base address by default
	from NutRegisterDevice. Also a hardware depended reset method is
	disabled by default.

	To get back the old functionality define NUT_CS8900_OLD

2004-05-24  Oliver Schulz  <olischulz@web.de>

	* include/dev/usart.h, dev/usart.c, dev/usart0avr.c, dev/usart1avr.c:
	Implemented function dev_size, which retrieves the number of bytes in
	input buffer.

	* include/dev/uart.h, dev/uartavr.c, dev/uart0.c, dev/uart1.c: ditto.

	* crt/kbhit.c, crt/Makefile: Added function kbhit(). Returns nonzero if
	stdin has at least one char in input buffer. Uses _filelength to get the
	file size.


2004-05-23  Oliver Schulz  <olischulz@web.de>

	* include/arch/avr.h: Added some macros, because they are no longer
	available since version 1.1.0 of avr-libc.


2004-05-21  Matthias Ringwald <mringwal@inf.ethz.ch>

        * configure: defined MCU for *nix emulation as 'unix', so libs can go
        into lib/gcc/unix. MCU names like 'i386' and 'ppc' would be better.

2004-05-20  Oliver Schulz  <olischulz@web.de>

	* dev/usart.c: Memory was allocated twice for NUTFILE in UsartOpen.


2004-05-17  Harald Kipp  <harald.kipp@egnite.de>

        * include/dev/nicrtl.h, dev/nicrtl.c: Added major changes,
        which had been contributed by Bengt Florin. This driver
        uses polling for transmission, which may look like a
        disadvantage. In fact it became rock solid, hardly no
        packet loss even under very heavy traffic.


2004-05-16  Matthias Ringwald <mringwal@inf.ethz.ch>

	* os/mutex.c, include/sys/mutex.h: added recursive mutex implementation

	* os/semaphore.c, include/sys/semaphore.h: added semaphore implementation

	* os/Makefile: added above files


2004-05-16  Oliver Schulz  <olischulz@web.de>

	* dev/usartavr.c: Applied bugfixes for half duplex mode and XON/XOFF
	handling. Thanks to Damian Slee.


2004-05-17  Harald Kipp  <harald.kipp@egnite.de>

	* include/dev/nicrtl.h, dev/nicrtl.c: Added major changes,
	which had been contributed by Bengt Florin. This driver
	uses polling for transmission, which may look like a
	disadvantage. In fact it became rock solid, hardly no
	packet loss even under very heavy traffic.


2004-04-25  Oliver Schulz  <olischulz@web.de>

	* include/dev/irqstack.h, dev/irqstack.h, os/arch/avr_thread.c:
	Modified to be compatible with nested interrupts. Every time a interrupt
	occurs, a counter is incremented. If the counter is zero, the stack
	switch is performed. After the isr returns, the counter is decremented.
	An additional variable _irqstackdec defined in os/arch/avr_thread.c. The
	stack size of each new thread will be decremented by this value.


2004-04-15  Oliver Schulz  <olischulz@web.de>

	* pro/dhcpc.c: Added support for hostname also in DHCPDiscover.

	* pro/resolv.c: If the DNS server answers with more than one record, and
	the first has no ip address (CNAME), the function failed.

	* pro/resolv.c, include/netdb.h: New function NutDnsGetMxByDomain to
	request an MX record from DNS server.


2004-04-15  Harald Kipp  <harald.kipp@egnite.de>

	* eboot: Ethernet boot loader for RTL8019AS added.

	* crt/feof.c, crt/ferror.c, crt/fread.c, crt/nut_io.h:
	Stream functions feof() and ferror() do now return meaningful
	results.

	* net/tcpout.c: Retransmission timer not always set in the
	state machine. Initializing it when the first entry is added
	to the transmit buffer is a much better idea. However, now
	we have a unique retransmission in every situation. Again,
	it is most important to implement round trip time calculation.

	* net/tcpsm.c: The state machine did not increment the sequence
	number on FIN segments. Thus, FIN segments were never
	retransmitted and connections weren't properly closed.

	* net/tcpsm.c: The packet drop problem of the Realtek driver
	could be observed quite often in HTTP applications, where
	the browser concurrently opened several connections. Adding
	a slight delay during SYN and FIN receptions remarkably
	reduced the problem. This delay is activated only, if
	RTLCONNECTHACK has been defined. Note, that this is a
	temporary hack, but it really helps some applications.


2004-04-07  Harald Kipp  <harald.kipp@egnite.de>

	* Added Matthias Ringwald's patches, which enable Nut/OS
	emulation running on Linux and Mac OS X.

	* dev/usartavr.c: Half duplex operation failed if direction
	is not controlled by RTS. Thanks to Dusan Ferbas for reporting
	this problem and providing a solution. Dusan also found out,
	that half duplex is not enabled by _ioctl(UART_SETFLOWCONTROL)
	alone. As a temporary fix, call _ioctl(UART_SETSPEED) after
	setting flow control.


2004-03-19  Jan Dubiec  <jdx@slackware.pl>

	* os/event.c, os/heap.c, os/osdebug.c, os/thread.c, os/timer.c,
	net/netdebug.c: Format strings declarations has been changed
	to static prog_char in order to save data memory and print debug
	messages properly on AVR.

	* configure: Added "-mint32" switch to H8 gcc options so "int"
	is now 32 bit on H8/300H and H8S.

	* include/dev/mweeprom.h, dev/mweeprom.c: u_char and u_short
	changed to unsigned char and unsigned short accordingly in order
	to avoid compilation problems on H8 microcontrollers: mweeprom.h
	is included by compiler.h and compiler.h in included by sys/types.h
	so u_char and u_short were used before they were defined. The
	occurence of this problem depended on place in sys/types.h in which
	compiler.h was included.

	* arch/h8300h/include/h83068f.h: Added comment about the origin of
	this file.


2004-03-18  Harald Kipp  <harald.kipp@egnite.de>

	* include/arch/avr.h: Removed Harvard architecture definition.
	It's required in UserConf.mk.

	* dev/uartavr.c: Removed deprecated raw I/O.

	* os/devclose.c, os/devioctl.c, os/devopen.c, os/devread.c,
	os/devtran.c, os/devwrite.c, os/ifstran.c, os/ifstream.c,
	os/init.c, os/print.cnet/sostream.c: Deprecated functions
	from version 2 finally removed.

	* sys/atomic.h: Unused file removed to simplify portability.

	* sys/devtran.h, sys/ifstran.h, print.h, netinet/sostream.h:
	Deprecated prototypes removed.

	* sys/device.h, sys/ifstream.h: Second header file removed.
	The IFSTREAM structure is still used by some device drivers
	and has been moved to sys/device.h.

	* pro/resolv.c: Deprecated header file replaced.

	* pro/dhcpc.c, include/pro/dhcp.h: Deprecated NutNetAutoConfig
	removed.

	* fs/uromfs.c, include/fs/uromfs.h: Deprecated NutRom functions
	removed.

	* net/arpcache.c, net/icmpin.c, net/ifconfig.c, if_var.h:
	Comments updated.

	* doc/copying-gpl.txt, doc/copying-liquorice.txt:
	Added as required by Liquorice's licence.

	* net/pppin.c: Avoid calculation with void pointers.

	* include/sys/types.h: compiler.h must be included
	early to allow definitions of platform dependant
	macros.

	* include/compiler.h, include/sys/nutconfig.h: Added ATMEGA
	macro for ICCAVR support.

	* include/stdio.h: stddef header inclusion removed.

	* include/dev/irqreg.h: Bugfix. ICCAVR can't find header files.

	* include/arch/avr.h: Added __AVR_ATmega103__ in ICCAVR block.

	* dev/term.c, include/dev/term.h: Added Michael Fischer's
	TIOCGWINSZ ioctl.

	* dev/irsony.c: Infrared interrupts now working. Thanks to
	Michael Fischer, who reported this problem.

	* Added Michael Fischer's WLAN driver almost unchanged. I had
	to make some changes though, because the code mixes int
	variables with long constants. GCC is very picky in these
	things. This compiler also throws warnings, if static functions
	or local variables are unused. Remember, we compile with -Werror.
	I have marked my changes with '/* Harald:'. Additionally I
	blindly put all in dev/ and updated the includes. FInally it
	compiles, but not sure, what it does. The code needs some
	extra care, but due to demand I put it in CVS in its current
	state. If it breaks something, please remove it from the
	Makefile.


2004-03-17  Harald Kipp  <harald.kipp@egnite.de>

	* include/dev/chat.h, include/sys/atom.h: Bugfix, ICCAVR
	does not define __AVR__.

	* irqreg.c, avr_irqreg.c: Deprecated AVR interrupt registration
	removed.

	* include/arch/avr.h: Define Harvard architecture for AVR by
	default.


2004-03-16  Harald Kipp  <harald.kipp@egnite.de>

	* Jan Dubiec's H8/300 port added. This breaks at least the
	make process on Windows machines. Jan's work is substantial,
	so I added his diff regardless of any existing code. Actually
	his code is very clean and porting it back again for the
	Windows environment should be easy.


2004-03-14  Harald Kipp  <harald.kipp@egnite.de>

	* dev/ppp.c, include/dev/ppp.h: Compile problems fixed, thanks
	to Jan Dubiec.


2004-03-09  Harald Kipp  <harald.kipp@egnite.de>

	* include/dev/ahdlcavr.h: This one was missing.


2004-03-08  Harald Kipp  <harald.kipp@egnite.de>

	* dev/ahdlc*.c: Asynchronous HDLC driver added.

	* dev/chat.c, include/dev/chat.h: Debug output added.

	* dev/lanc111.c: Quick hack for fixed mode added. Should be replaced
	by ioctl() function.

	* dev/ppp.c, include/netinet/ppp_fsm.h, net/pppout.c, net/pppsm.c:
	HDLC functions moved to async HDLC driver.

	* include/cfg/modem.h: Hardware handshake disabled by default.

	* include/sys/msg.h: Not all compilers like arrays of size zero.
	Hopefully there are no side effects, but at least ICCAVR compiles it.

	* net/icmpout.c: Not all compilers like pointer calculation with
	void pointers.

	* net/ifconfig.c: Ugly PPP activation hack replaced by HDLC ioctl.

	* net/ipcpin.c: PppUp() replaced by direct post.

	* net/lcpin.c, net/pppdebug.c, net/pppin.c: PPP header compression
	on incoming packets accepted. Thanks to Francois Rademeyer.

	* net/lcpout.c: Bugfix, establishing PPP sessions failed. Thanks to
	Zoltan Korbai.


2004-03-05  Oliver Schulz  <olischulz@web.de>

	* os/tmr_avr.c: Bugfix in NutTimerInit. ICCAVR failed to compile, if
	NUT_CPU_FREQ is defined.


2004-03-03  Oliver Schulz  <olischulz@web.de>

	* crt/fpurge.c, crt/Makefile: Added function 'fpurge'. This is only a
	wrapper for calling the device read function with buffer pointer set to
	zero to purge a stream, i.e. discard any input buffer.

	* include/sys/confos.h, os/confos.h, app/basemon/basemon.c, pro/dhcpc.c,
	os/init.c, os/nutinit.c: Structure confos was extended to store the
	system's hostname in EEPROM. This hostname is reported to DHCP server
	while requesting a DHCP lease.

	* os/confos.c, os/init.c: Bugfix in NutSaveConfig. Write only to eeprom
	if actual byte in eeprom differs from byte to write.


2004-03-02  Oliver Schulz  <olischulz@web.de>

	* pro/httpd.c: Bugfix in NutHttpSendError. Appended \r\n to auth_fmt_P
	to write the next header line to a new line.


2004-02-28  Oliver Schulz  <olischulz@web.de>

	* net/tcpsm.c: Bugfix in several tcp state functions. Swapped around the
	check for ACK and SYN flag. Because initial SYN packets don't have an
	ACK flag, recevied SYN packets were never rejected.

	* pro/resolv.c: Memory leak fixed in CreateDnsQuestion.

	* crt/getf.c: Several bugfixes applied.
 	- "%%" didnt work.
 	- integer parsing corrected.
 	- support for "%u".


2004-02-01  Harald Kipp  <harald.kipp@egnite.de>

	* dev/debug*.c: Added ioctl baudrate support.

	* dev/lanc111.c, net/ifconfig.c: Avoid chip initialization with MAC
	address zero. This is a quick hack for all this init mess.

	* include/pro/dhcp.h: Added NutDhcpRelease prototype.

	* pro/dhcpc.c: New API added to relinguish the DHCP lease.
	Collecting more than one offer is now disabled, if the application
	sets timeout below three times of MAX_DHCP_WAIT (5 seconds).
	The lease renewal will now start when 3/4 has elapsed, opposed
	to 1/2 used previously. Finally the DHCP thread will sleep as
	long as possible, while the previous version woke up every
	ten seconds.


2004-02-01  Harald Kipp  <harald.kipp@egnite.de>

	* appload/appload.c, appload/ip.c: Bugfix. SMSC bootloader failed if
	DHCP offer is not broadcasted. Now IP input routine accepts any target
	IP while our local IP is unconfigured.


2004-02-18  Oliver Schulz  <olischulz@web.de>

	* os/ctx_*.c: Bugfix in NutThreadCreate. If NutHeapAlloc fails, the
	function returned without calling NutExitCritical to reenable
	interrupts.


2004-02-08  Oliver Schulz  <olischulz@web.de>

	* net/arpcache.c: Arp entries with set ATF_PERM are not removed from the
	cache list any more.


2004-02-06  Oliver Schulz  <olischulz@web.de>

	* net/icmpin.c, net/icmpout.c: After my last changes, ping didn't work
	any more. Thanks to Pavel Celeda, who discovered this bug.


2004-02-04  Oliver Schulz  <olischulz@web.de>

	* os/msg.c, include/sys/msg.h, os/Makefile: First version of message
	queueing  implemented. Thanks to Ralph Mason, who provided this code.
	Still contains some debug functions.


2004-02-02  Oliver Schulz  <olischulz@web.de>

	* include/net/if_var.h, net/ifconfig.c, pro/dhcp.c: Gateway ip
	address was not set, if static network configuration from
	EEPROM is used.

	* net/icmpin.c, net/icmpout.c, net/ipin.c, net/tcpsm.c,
	include/sys/socket.h, include/netinet/icmp.h: Added some more ICMP
	support. Now the network stack handles incoming ICMP unreachable
	messages, and aborts appropiate TCP sockets.


2004-02-01  Harald Kipp  <harald.kipp@egnite.de>

	* include/compiler.h, os/timer.c, os/thread.c: Additional support
	started for ARM7TDMI, H8/300 and Coldfire.

	* os/ctx_CPU.c: Split os/thread.c by CPU families.

	* os/tmr_CPU.c: Split os/timer.c by CPU families.

	* include/cpu/CPU.h: Split include/compiler.h by CPU families.


2004-01-30  Harald Kipp  <harald.kipp@egnite.de>

	* Version 3.4 release candidate.

	* appload/tftpd.c: Ethernut 2 bootloader failed to load
	files larger than 64kB.

	* net/ipcpin.c: Fixed a memory hole in case of incoming IPCP
	with bad identifiers.

	* net/lcpout.c: Added a parameter to LcpTxConfReq to handle
	rejected magic number requests. This is a dirty hack, but
	should help for now. All calls in lcpin.c and pppsm.c plus
	the prototype in include/netinet/if_ppp.h had been adapted as
	well. Thanks to Alex Joni and Zoltan Korbai, who discovered
	this problem.


2004-01-30  Oliver Schulz  <olischulz@web.de>

	* include/dev/irqreg.h, include/dev/irqstack.h, dev/irqstack.c,
	dev/ivect??.c, dev/Makefile: Separate interrupt stack for avr-gcc only
	implemented. Size of this stack is 256 bytes. May be changed later. The
	interrupt stack reduces the stack space needed for every thread, because
	if an interrupt occurs, the stack pointer is immediately changed to the
	interrupt stack and the thread stack is no longer used while executing
	interrupt code.


2004-01-25  Oliver Schulz  <olischulz@web.de>

	* net/tcpsm.c: Bugfix for establishing tcp connections by
	calling NutTcpConnect. If no answer is received, retransmission
	is stoped after about 6 secs. If RST if received, the
	connection request is now properly aborted and the error is
	returned to the caller.


2004-01-14  Oliver Schulz  <olischulz@web.de>

	* pro/dhcpc.c, include/pro/dhcp.h: Applied changes by Damian
	Slee. Now it should be possible to obtain gateway and dns
	server ip address from Win2k DHCP servers.
	
	* net/lcpin.c: Same bug fix like in IpcpRxConfReq applied
	also to LcpRxConfReq.
	
	* dev/lanc111.c: Speed improvements for transfering bytes
	from and to nic applied.
	
	* net/tcpsock.c: New TCP output buffering implemented. If not
	configured, it works nearly like the old buffering. To
	configure, use NutTcpSetSockOpt with new option SO_SNDBUF.
	
	* net/tcpsm.c: Now the retransmission timer is also
	started on call of NutTcpConnect.


2004-01-04  Oliver Schulz  <olischulz@web.de>

	* app/basemon/basemon.c: After adding thread termination
	support to Nut/OS, the priority of basemon's own idle
	thread was also changed from 255 to 254 to avoid idle thread
	termination.


2003-12-19  Oliver Schulz  <olischulz@web.de>

	* include/time.h, crt/time.c, crt/mktime.c, crt/gmtime.c
	crt/localtim.c: Dox written.


2003-12-18  Harald Kipp  <harald.kipp@egnite.de>

	* include/dev: Added missing usart driver include files.


2003-12-15  Harald Kipp  <harald.kipp@egnite.de>

	* os/version.c: Switched to 3.3.3, still preview.

	* os/thread.c: Long awaited support for terminating
	threads had been implemented. The context switch frame
	has been reduced to those registers, which really need
	to be saved. These most valuable changes had been
	contributed by Ralph Mason.

	* os/nutinit.c: Destroys terminated threads. Priority
	255 is used to terminate threads, thus the idle thread's
	priority changed from 255 to 254. This may break your
	existing application. Thanks again to Ralph Mason.

	* appicc: Imagecraft projects updated to version 6.29.

	* dev/usart.c: Hardware independant U(S)ART device driver
	added.

	* dev/usartavr.c: ATmega128/103 USART hardware support
	for new usart.c. Includes HW/SW handshake, 9-bit and
	synchronous communication.

	* include/fcntl.h: Dox updated.

	* include/bankmem.h: Banking enabled with Ethernut 2.


2003-12-12  Oliver Schulz  <olischulz@web.de>

	* crt/putf.c: Rewritten support for strings stored in prgram
	space. Using still type character 'P', but also some heap
	to store the string in RAM before the output function is
	called.
	
	
2003-12-06  Oliver Schulz  <olischulz@web.de>

	* os/nutinit.c, os/init.c: Using __heap_start instead of
	__bss_end to support .noinit section under gcc.

	* os/nutinit.c: changed external RAM detection. Now it's
	possible to used more than 4KB static data under gcc.


2003-11-28  Harald Kipp  <harald.kipp@egnite.de>

	* net/tcpsm.c: TCP connections suddenly drop during
	transmission. Bug in retransmission timer fixed.


2003-11-27  Oliver Schulz  <olischulz@web.de>

	* pro/dencode.c: Bug fix and code size improvement


2003-11-26  Oliver Schulz  <olischulz@web.de>

	* nutlibcrt.a: Added some standard C time functions to
	implement time handling and real time clocks.

	* pro/sntp.c: Added SNTP protocol to retreive universal
	coordinated time (UCT) from SNTP servers.

	* net/udpin.c, net/udpsock.h: Added a configurable receive
	packet queue for UDP packets.

	* crt/putf.c: Added support for program space character
	strings (%P).


2003-11-05  Harald Kipp  <harald.kipp@egnite.de>

	* Version 3.3.2

	* app/pppc.c: Added a note, that this will not work with
	ATmega103 chips as long as debugging is enabled, which
	requires a second UART.

	* dev/lanc111.c: Leftover from debugging set last byte
	of MAC address to 1.


2003-11-04  Harald Kipp  <harald.kipp@egnite.de>

	* All applications will work on Ethernut 1 and 2.

	* net/tcpsm.c: Race condition in TCP state machine left
	socket in CLOSE-WAIT state. Fixed.

	* app/basemon: Ignore PD5 in port test. Used with RS485.

	* dev/lanc111.c: Still link problems. Finally it should
	work now after correcting delays during PHY configuration.


2003-11-03  Harald Kipp  <harald.kipp@egnite.de>

	* app/isp2: New application to update the ISP adapter
	included in the Ethernut Starter Kit.

	* app/basemon: Rewritten to support RTL8019AS and
	LAN91C111 Ethernet Controllers and banked memory.

	* appload: New bootloader for LAN91C111 added.

	* include/lanc111.h: Allow applications to link
	both Ethernet Controller Drivers.

	* dev/lanc111.c: Several optimizations and bugfixes.
	The driver will reliably link now on 10 MBit networks.
	Sudden buffer allocation failures had been fixed by
	resetting the MMU in this situation.

	* pro/dhcpc.c: Renewal disabled, if lease time is set
	to zero

	* os/timer.c: New API function returns system uptime in
	miliseconds. This function is now used by the TCP state
	machine to calculate retransmission timeouts. Another
	step towards round trip time calculation, which is
	still missing in Nut/Net.

	* include/compiler.h: New register types added for
	better portability to different MCU platforms.

	* dev/twif.c: Documentation of API calls enhanced.


2003-10-14  Harald Kipp  <harald.kipp@egnite.de>

	* tools/nutconf: New GUI configuration tool named nutconf.
	Based on the excellent wxWindows class library.

	* crt/icc: Imagecraft runtime initialization added to
	the CVS repository.


2003-10-13  Harald Kipp  <harald.kipp@egnite.de>

	* dev/lanc111.c: New driver for SMSC LAN91C111 provides
	100 Mbps Ethernet interface.

	* os/timer.c: Added a seconds counter.

	* pro/dhcpc.c: Replaced tick counter with seconds
	counter. This should fix the DHCP timer bug.

	* Added hardware definition to Makedef files.


2003-09-03  Harald Kipp  <harald.kipp@egnite.de>

	* Tested with WinAVR-20030913

	* app/httpd/httpserv.c: Using strtok and portable
	version of strtok_r.

	* crt/srttok_r.c: Incompatible strtok_r marked
	deprecated and removed from GCC compile.

	* os/nutinit.c: XRAMEND replaced by NUTRAMEND to avoid
	GCC conflicts.

	* app/nutpiper/player.c: Include file sequence changed.

	* app/nutpiper/scanner.c: dito.

	* dev/chat.c: Report function contributed by Jelle
	Martijn Kok.


2003-08-14  Harald Kipp  <harald.kipp@egnite.de>

	* Version 3.3.1

	* app/pppc.c: PPP sample added.

	* crt/putf.c: Formatted output of unsigned int fixed
	by Ralph Mason.

	* dev/ppp.c: Bugfix, HDLC may only use a single flag
	between two consecutive frames.

	* Avoid changing the PPP request identifier while
	resending unanswered frames.

	* net/lcpout.c: Negotiate local PPP magic.

	* net/lcpin.c: LCP echo reply support added.

	* net/lcpout.c: Bugfix, send protocol reject in correct
	byte order.

	* net/pppdebug.c: Added support for LCP echo and
	discard frames.

	* net/pppsm.c: Retry for authentication request added.

	* net/tcpsm.c: Bugfix by Ralph Mason, NutTcpAccept
	fails if caller got higher priority.

	* net/tcpsm.c: Bugfix by Ralph Mason, incoming TCP
	NETBUFs will never be released if TCP is not used by
	application.

	* net/tcpsock.c: Another fix by Ralph, TCP may reuse
	socket ports because of wrong byte order during
	compare.


2003-08-07  Harald Kipp  <harald.kipp@egnite.de>

	* app/httpd/httpserv.c: Bugfix, remote not displayed
	in the socket list.

	* pro/dhcpc.c: Complete redesign to follow RFC 2131.


2003-08-05  Harald Kipp  <harald.kipp@egnite.de>

	* app: Examples updated and checked in.

	* Removed DNS entries from network interface
	structure. This may break your driver/app.

	* dev/nicrtl.c: Bugfix, failed to boot with empty
	EEPROM.

	* include/compiler.h: Added strcmp_P(), outb() and
	_BV() for ICCAVR.


2003-07-24  Harald Kipp  <harald.kipp@egnite.de>

	* net/ipcpin.c: Bugfix, PPP always used the secondary
	DNS.

	* net/ipcpout.c: When the PPP server rejects the
	secondary DNS, IPCP negotiation was trapped in a
	loop.


2003-07-23  Harald Kipp  <harald.kipp@egnite.de>

	* Michael Fisher contributed the first ATAPI version
	of his IDE driver and FAT filesystem. Note, that the
	IDE port moved from 0x8000 to 0xE000.


2003-07-21  Harald Kipp  <harald.kipp@egnite.de>

	* Version 3.3 prepared for release.

	* os/bankmem.c: Support for banked memory added.

	* os/ir.c: Support for infrared remote control added.

	* dev/irsony.c: First infrared remote control driver
	for Sony TV codes.

	* dev/vs1001k.c: Internal buffer handling replaced by
	banked memory support routines.

	* app/nutpiper: New application. Shoutcast radio with
	remote control, LCD displayand banked memory support.
	Experimental.


2003-07-20  Harald Kipp  <harald.kipp@egnite.de>

	* pro/httpd.c: Reduced RAM usage by moving string
	literals to program space.

	* net/ipout.c: Memory hole bugfix.

	* net/udpsock.c: System crash on UDP send failure
	has been fixed.

	* app/httpd: Redesigned HTTP server sample added.

	* dev: New Ethernet driver for CS8900A.

	* crt/vsscanf.c: Bugfix for sscanf functions.

	* crt/sprintf_p.c: Bugfix.

	* crt/filelength.c: Wrong description replaced.

	* pro/dhcpc.c: Added code to support secondary DNS.

	* pro/resolve.c: Dito.

	* No explanation had been given how to disable the
	timeout of several functions using NutEventWait().
	A defined value of NUT_WAIT_INFINITE has been added
	to event.h.

	* Missing directories added to repository.

	* urom filesystem filenames moved to program space
	to save RAM.

	* Conflicting Ethernet driver routine names solved.


2003-07-17  Harald Kipp  <harald.kipp@egnite.de>

	* dev/hd44780.c: Works with applications which may
	change the data direction registers.

	* dev/nicrtl.c: Speed enhancements and being less
	strictly for accepting valid frames.

	* dev/twif.c: Missing speed settings added.

	* pro/dhcpc.c: No more default (egnite) MAC address.

	* pro/httpd.c: Memory hole fixed.


2003-07-13  Harald Kipp  <harald.kipp@egnite.de>

	* ChangeLog: Added.

	* net/confnet.c: Unconfigured MAC address changed to
	broadcast address.

	* net/tcpsm.c: Changing the socket data buffer into
	a NETBUF queue results in faster TCP transfers.

	* net/tcpsock.c: dito.

	* include/sys/sock_var.h: dito.
